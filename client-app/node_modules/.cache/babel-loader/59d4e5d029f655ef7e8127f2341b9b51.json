{"ast":null,"code":"import _objectSpread from\"/Users/aristos/Documents/Fall_2021/COEN_241/CloudComputingTermProject/client-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/aristos/Documents/Fall_2021/COEN_241/CloudComputingTermProject/client-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import Calendar,{CalendarDayHeader}from\"./components/Calendar\";import StepHeader from\"./components/StepHeader\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import{getRangeOfDates}from\"./components/EventHelpers\";import dayjs from\"dayjs\";import dayOfYear from\"dayjs/plugin/dayOfYear\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";dayjs.extend(dayOfYear);var CreateEvent1=function CreateEvent1(_ref){var navigate=_ref.navigate,setError=_ref.setError,error=_ref.error,user=_ref.user;var _useState=useState([2021,11]),_useState2=_slicedToArray(_useState,2),yearAndMonth=_useState2[0],setYearAndMonth=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),nextpage=_useState4[0],setNextPage=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),eid=_useState6[0],setEid=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),collaborator=_useState8[0],setCollaborator=_useState8[1];//email\nvar _useState9=useState({name:\"\",//name of event\ncollaborators:[user.email],//array of users //added owner by default\ndates:[]}),_useState10=_slicedToArray(_useState9,2),eventDetails=_useState10[0],setEventDetails=_useState10[1];//-------date selection state -------///\nvar _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),dateCount=_useState12[0],setDateCount=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),startDate=_useState14[0],setStartDate=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),endDate=_useState16[0],setEndDate=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),middleDateRange=_useState18[0],setMiddleDateRange=_useState18[1];var selection=function selection(dateString){if(dateCount===2){console.log(\"Removed date selections\");setDateCount(0);setStartDate(\"\");setEndDate(\"\");setMiddleDateRange([]);}else if(dateCount===0){console.log(\"FirstDate Selected: \"+dateString);setDateCount(1);setStartDate(dateString);console.log(\"In CreateEvent: startDate= \"+startDate);}else{console.log(\"SecondDate Selected: \"+dateString);setDateCount(2);setEndDate(dateString);console.log(\"In CreateEvent: endDate= \"+endDate);if(startDate===endDate){//if only one day selected\nsetEventDetails(_objectSpread(_objectSpread({},eventDetails),{},{dates:[startDate]}));}else{var dateRange=getRangeOfDates(startDate,dateString);//setEventDetails({...eventDetails, dates: dateRange})\n//make middle date range\n//console.log(dateRange)\ndateRange.shift();dateRange.pop();setMiddleDateRange(dateRange);//remove first and last date\n//console.log(middleDateRange) //these are not coming in on time\n}}};useEffect(function(){var dateRange=getRangeOfDates(startDate,endDate);console.log(\"endDate from useEffect= \"+endDate);setEventDetails(_objectSpread(_objectSpread({},eventDetails),{},{dates:dateRange}));},[startDate,endDate]);var nextClickHandler=function nextClickHandler(e){e.preventDefault();if(dateCount!==2){setError(\"Must pick start and end dates. For only one day, reselect it and continue\");}else{setError(\"\");// const dateRange = getRangeOfDates(startDate, endDate)\n// setEventDetails({...eventDetails, dates: dateRange})\nconsole.log(\"next \"+eventDetails.dates);setNextPage(!nextpage);}};var addClickHandler=function addClickHandler(e){e.preventDefault();var email={email:collaborator};axios.post(\"http://localhost:4000/api/validate-email\",email).then(function(response){if(response.data){console.log(\"Correct Collaborator email\");setError(\"\");console.log(response.data.data.email);var userEmails=eventDetails.collaborators;//array of emails\nuserEmails.push(response.data.data.email);//add user email to array\nsetEventDetails(_objectSpread(_objectSpread({},eventDetails),{},{collaborators:userEmails}));//reassign collaborators with correct\nconsole.log(\"List of Collaborators: \"+userEmails);//user is the full record of user, so use this info to make <div> to display name in chart\n}else{console.log(\"No email match\");setError(\"Email does not exist\");}setCollaborator(\"\");//clears email text-field\n});};var submitClickHandler=function submitClickHandler(){var event={eventname:eventDetails.name,userid:user.id,owner:user.username,collaborators:eventDetails.collaborators};console.log(event);axios.post(\"http://localhost:4000/api/create-event\",event).then(function(response){if(response.data){console.log(\"Event created\");setError(\"\");console.log(response.data);setEid(response.data.eventId);//not being set in time\nconsole.log(\"eid: \"+eid);//do post in here for timeslots//\nvar timeslotData={eventid:response.data.eventId,collaborators:eventDetails.collaborators,dates:eventDetails.dates};console.log(\"timeslotData.eventid= \"+timeslotData.eventid);axios.post(\"http://localhost:4000/api/create-timeslots\",timeslotData).then(function(response){if(response.data){console.log(\"Timeslots Created!\");setError(\"\");console.log(response.data);navigate(\"/dashboard\");}else{console.log(\"Timeslots couldn't be set\");setError(\"Timeslots couldn't be set\");}});//post for timeslots in here conditionally\n}else{console.log(\"Event couldn't be created\");setError(\"Event couldn't be created\");}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-400 w-full h-full text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 mx-auto\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-white text-7xl font-bold tracking-tight pt-10\",children:\"MeetUp\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-yellow-300 text-4xl font-medium tracking-wide py-10 border-b-2 \",children:\"Create Event\"})]}),!nextpage&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(StepHeader,{num:\"1\",text:\"Select up to 7 days\"}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:min-w-auto mx-auto container\",children:/*#__PURE__*/_jsx(Calendar,{startDate:startDate,middleDateRange:middleDateRange,endDate:endDate,selection:selection,yearAndMonth:yearAndMonth,onYearAndMonthChange:setYearAndMonth,renderDay:function renderDay(calendarDayObject){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CalendarDayHeader,{calendarDayObject:calendarDayObject})});}})}),error!==\"\"?/*#__PURE__*/_jsx(\"div\",{className:\"py-5 text-xl text-red-200\",children:error}):\"\",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){navigate(\"/dashboard\");},className:\" my-10 mx-10 text-4xl border-b-2 border-blue-900 text-blue-900 hover:border-blue-800 hover:text-gray-600 cursor-pointer\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:nextClickHandler,className:\" my-10 text-4xl border-b-2 border-blue-900 text-blue-900 hover:border-blue-800 hover:text-gray-600 cursor-pointer\",children:\"Next\"})]}),nextpage&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row justify-between mx-auto w-5/6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(StepHeader,{num:\"2\",text:\"Name your event\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setEventDetails(_objectSpread(_objectSpread({},eventDetails),{},{name:e.target.value}));},value:eventDetails.name,type:\"text\",name:\"name\",id:\"name\",placeholder:\"name\",className:\"block border-b-2  border-0 border-gray-500 text-3xl text-yellow-300 mx-auto py-0 px-4 focus:outline-none bg-purple-400\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(StepHeader,{num:\"3\",text:\"Add collaborators\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setCollaborator(e.target.value);},value:collaborator,type:\"email\",name:\"email\",id:\"email\",placeholder:\"email\",className:\"block border-b-2  border-0 border-gray-500 text-3xl text-yellow-300 mx-auto py-0 px-4 focus:outline-none bg-purple-400\"}),error!==\"\"?/*#__PURE__*/_jsx(\"div\",{className:\"py-5 text-xl text-red-200\",children:error}):\"\",/*#__PURE__*/_jsx(\"button\",{onClick:addClickHandler,className:\" my-10 text-3xl border-b-2 border-blue-900 text-blue-900 hover:border-blue-800 hover:text-gray-600 cursor-pointer\",children:\"Add\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-32 rounded-md shadow-md bg-gray-700 mb-10\",children:eventDetails.collaborators.map(function(user){return/*#__PURE__*/_jsx(\"div\",{className:\"text-white text-2xl\",children:user},user);})})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:nextClickHandler,className:\" my-10 mx-10 text-3xl border-b-2 border-yellow-300 text-yellow-300 hover:border-yellow-400 hover:text-yellow-400 cursor-pointer\",children:\"Back\"}),/*#__PURE__*/_jsx(\"button\",{onClick:submitClickHandler,className:\" my-10 text-3xl border-b-2 border-yellow-300 text-yellow-300 hover:border-yellow-400 hover:text-yellow-400 cursor-pointer\",children:\"Submit\"})]})]});};export default CreateEvent1;","map":{"version":3,"sources":["/Users/aristos/Documents/Fall_2021/COEN_241/CloudComputingTermProject/client-app/src/pages/CreateEvent1.js"],"names":["useState","useEffect","Calendar","CalendarDayHeader","StepHeader","useNavigate","axios","getRangeOfDates","dayjs","dayOfYear","extend","CreateEvent1","navigate","setError","error","user","yearAndMonth","setYearAndMonth","nextpage","setNextPage","eid","setEid","collaborator","setCollaborator","name","collaborators","email","dates","eventDetails","setEventDetails","dateCount","setDateCount","startDate","setStartDate","endDate","setEndDate","middleDateRange","setMiddleDateRange","selection","dateString","console","log","dateRange","shift","pop","nextClickHandler","e","preventDefault","addClickHandler","post","then","response","data","userEmails","push","submitClickHandler","event","eventname","userid","id","owner","username","eventId","timeslotData","eventid","calendarDayObject","target","value","map"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport Calendar, { CalendarDayHeader } from \"./components/Calendar\";\nimport StepHeader from \"./components/StepHeader\"\nimport {useNavigate} from \"react-router-dom\"\nimport axios from \"axios\"\nimport { getRangeOfDates } from \"./components/EventHelpers\"\nimport dayjs from \"dayjs\";\nimport dayOfYear from \"dayjs/plugin/dayOfYear\";\n\ndayjs.extend(dayOfYear)\n\nconst CreateEvent1 = ({navigate, setError, error, user}) => {\n    const [yearAndMonth, setYearAndMonth] = useState([2021, 11]);\n    const [nextpage, setNextPage] = useState(false)\n    const [eid, setEid] = useState(0)\n    const [collaborator, setCollaborator] = useState(\"\") //email\n    const [eventDetails, setEventDetails] = useState({\n        name: \"\", //name of event\n        collaborators: [user.email], //array of users //added owner by default\n        dates: []\n    })\n\n    //-------date selection state -------///\n    const [dateCount, setDateCount] = useState(0) \n    const [startDate, setStartDate] = useState(\"\")\n    const [endDate, setEndDate] = useState(\"\")\n    const [middleDateRange, setMiddleDateRange] = useState([])   \n\n    const selection = (dateString) => {\n         if (dateCount === 2) {\n            console.log(\"Removed date selections\")\n            setDateCount(0)\n            setStartDate(\"\")\n            setEndDate(\"\")\n            setMiddleDateRange([])\n         }\n         else if (dateCount === 0) {\n            console.log(\"FirstDate Selected: \" + dateString)\n            setDateCount(1)\n            setStartDate(dateString)\n            console.log(\"In CreateEvent: startDate= \" + startDate)\n         }\n         else {\n            console.log(\"SecondDate Selected: \" + dateString)\n            setDateCount(2)\n            setEndDate(dateString)\n            console.log(\"In CreateEvent: endDate= \" + endDate)\n            if(startDate === endDate) { //if only one day selected\n                setEventDetails({...eventDetails, dates: [startDate]})\n            }\n            else {\n                let dateRange = getRangeOfDates(startDate, dateString)\n                //setEventDetails({...eventDetails, dates: dateRange})\n                //make middle date range\n                //console.log(dateRange)\n                dateRange.shift()\n                dateRange.pop()\n                setMiddleDateRange(dateRange) //remove first and last date\n                //console.log(middleDateRange) //these are not coming in on time\n            }   \n         }\n    }\n\n    useEffect(() => {\n        const dateRange = getRangeOfDates(startDate, endDate)\n        console.log(\"endDate from useEffect= \" + endDate)\n        setEventDetails({...eventDetails, dates: dateRange}) \n    }, [startDate, endDate])    \n\n    const nextClickHandler = e => {\n        e.preventDefault()\n        \n        if (dateCount !== 2) {\n            setError(\"Must pick start and end dates. For only one day, reselect it and continue\")\n        }\n        else {\n            setError(\"\")\n            // const dateRange = getRangeOfDates(startDate, endDate)\n            // setEventDetails({...eventDetails, dates: dateRange})\n\n            console.log(\"next \" + eventDetails.dates)\n            \n            setNextPage(!nextpage)\n        }        \n    }\n    \n    const addClickHandler = e => {\n        e.preventDefault()\n\n        const email = { email: collaborator}\n        \n        axios.post(\"http://localhost:4000/api/validate-email\", email)\n        .then(response => {\n            if (response.data) {\n                console.log(\"Correct Collaborator email\");\n                setError(\"\")\n                console.log(response.data.data.email)\n                let userEmails = eventDetails.collaborators //array of emails\n                userEmails.push(response.data.data.email) //add user email to array\n                setEventDetails({...eventDetails, collaborators: userEmails}) //reassign collaborators with correct\n                \n                console.log(\"List of Collaborators: \" + userEmails)    \n                //user is the full record of user, so use this info to make <div> to display name in chart\n                \n\n            } else {\n                console.log(\"No email match\")\n                setError(\"Email does not exist\")\n            }\n            setCollaborator(\"\") //clears email text-field\n        })\n    }\n\n    const submitClickHandler = () => {\n\n        const event = {\n           eventname: eventDetails.name,\n           userid: user.id,\n           owner:  user.username,\n           collaborators: eventDetails.collaborators\n        }\n        \n        console.log(event)\n        axios.post(\"http://localhost:4000/api/create-event\", event)\n        .then(response => {\n            if (response.data) {\n                console.log(\"Event created\");\n                setError(\"\")\n                console.log(response.data)\n\n                setEid(response.data.eventId)\n                //not being set in time\n                console.log(\"eid: \" + eid)\n\n                //do post in here for timeslots//\n                const timeslotData = {\n                    eventid: response.data.eventId,\n                    collaborators: eventDetails.collaborators,\n                    dates: eventDetails.dates \n                }\n                console.log(\"timeslotData.eventid= \" + timeslotData.eventid)\n                axios.post(\"http://localhost:4000/api/create-timeslots\", timeslotData)\n                .then(response => {\n                    if (response.data) {\n                        console.log(\"Timeslots Created!\");\n                        setError(\"\")\n                        console.log(response.data)\n                        navigate(\"/dashboard\")\n                    } else {\n                        console.log(\"Timeslots couldn't be set\")\n                        setError(\"Timeslots couldn't be set\")\n                    }\n                }) \n\n                //post for timeslots in here conditionally\n\n            } else {\n                console.log(\"Event couldn't be created\")\n                setError(\"Event couldn't be created\")\n            }\n        }) \n\n         \n    }\n\n\n\n\n    return (\n        <div className=\"bg-purple-400 w-full h-full text-center\">\n            <div className=\"w-1/2 mx-auto\">\n                <h1 className=\"text-white text-7xl font-bold tracking-tight pt-10\">MeetUp</h1>\n                <h2 className=\"text-yellow-300 text-4xl font-medium tracking-wide py-10 border-b-2 \">Create Event</h2>\n            </div>\n            \n            {/* may want to use if statement with css visbility */}\n            {!nextpage &&   \n            <div>        \n                <StepHeader num=\"1\" text=\"Select up to 7 days\"/> \n                {/* <h3>{ if(dateCount) {\n                } From Nov 16 - Nov 18 //trying to display that\n                }</h3>  */}\n                <div className=\"lg:min-w-auto mx-auto container\">\n                    <Calendar\n                        startDate = {startDate}\n                        middleDateRange = {middleDateRange}\n                        endDate = {endDate}\n                        selection = {selection}\n                        yearAndMonth={yearAndMonth}\n                        onYearAndMonthChange={setYearAndMonth}\n                        renderDay={(calendarDayObject) => (\n                            <div>\n                                <CalendarDayHeader calendarDayObject={calendarDayObject} />\n                            </div>\n                        )}\n                    />\n                </div>\n                {(error !== \"\") ? ( <div className=\"py-5 text-xl text-red-200\">{error}</div>) : \"\"}\n                <button onClick={() => { navigate(\"/dashboard\")}} className=\" my-10 mx-10 text-4xl border-b-2 border-blue-900 text-blue-900 hover:border-blue-800\n                hover:text-gray-600 cursor-pointer\">Cancel</button>\n                <button onClick={nextClickHandler} className=\" my-10 text-4xl border-b-2 border-blue-900 text-blue-900 hover:border-blue-800\n                hover:text-gray-600 cursor-pointer\">Next</button>\n             </div>\n            }\n            {nextpage &&\n                <div>\n                    <div className=\"flex flex-row justify-between mx-auto w-5/6\">\n                        <div>\n                            <StepHeader num=\"2\" text=\"Name your event\"/>\n                            <input onChange={e => setEventDetails({...eventDetails, name: e.target.value})} value={eventDetails.name}\n                                type=\"text\" name=\"name\" id=\"name\" placeholder=\"name\" className=\"block border-b-2 \n                                border-0 border-gray-500 text-3xl text-yellow-300 mx-auto py-0 px-4 focus:outline-none bg-purple-400\"/> \n                        </div>\n                        <div>\n                            <StepHeader num=\"3\" text=\"Add collaborators\"/>\n                            {/* <FormInput type=\"email\"/> */}\n                            <input onChange={e => setCollaborator(e.target.value)} value={collaborator}\n                                type=\"email\" name=\"email\" id=\"email\" placeholder=\"email\" className=\"block border-b-2 \n                                border-0 border-gray-500 text-3xl text-yellow-300 mx-auto py-0 px-4 focus:outline-none bg-purple-400\"/> \n                            {(error !== \"\") ? ( <div className=\"py-5 text-xl text-red-200\">{error}</div>) : \"\"}\n                            <button onClick={addClickHandler} className=\" my-10 text-3xl border-b-2 border-blue-900 text-blue-900 hover:border-blue-800\n                                hover:text-gray-600 cursor-pointer\">Add\n                            </button> \n                            <div className=\"w-full h-32 rounded-md shadow-md bg-gray-700 mb-10\">\n                                {eventDetails.collaborators.map((user) => (\n                                  <div key={user} className=\"text-white text-2xl\">\n                                      {user}\n                                  </div>\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n                    <button onClick={nextClickHandler} className=\" my-10 mx-10 text-3xl border-b-2 border-yellow-300 text-yellow-300 hover:border-yellow-400\n                        hover:text-yellow-400 cursor-pointer\">Back\n                    </button>\n                    <button onClick={submitClickHandler}className=\" my-10 text-3xl border-b-2 border-yellow-300 text-yellow-300 hover:border-yellow-400\n                        hover:text-yellow-400 cursor-pointer\">Submit\n                    </button>\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default CreateEvent1"]},"metadata":{},"sourceType":"module"}